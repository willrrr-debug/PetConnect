# 本地启动管理系统指南

## 第一步：获取 Supabase Service Key

1. 打开浏览器，访问 https://supabase.com/dashboard
2. 选择你的项目
3. 点击左侧菜单的 **Settings** (设置)
4. 点击 **API**
5. 找到 **Project API keys** 部分
6. 复制 `service_role` 的 `secret` 值（⚠️ 不是 anon public）

## 第二步：配置后端环境变量

打开文件 `admin-backend/.env`，将第2行替换为你刚才复制的 Service Key：

```env
SUPABASE_SERVICE_KEY=你复制的service_role_key
```

**注意：** R2 配置是可选的，如果暂时没有 Cloudflare R2，可以先不配置，但图片上传功能将不可用（可以使用外部图片 URL）。

## 第三步：执行数据库脚本

1. 打开浏览器，访问 https://supabase.com/dashboard
2. 选择你的项目
3. 点击左侧菜单的 **SQL Editor**
4. 点击 **New query** 创建新查询
5. 复制 `supabase/admin-policies.sql` 文件的全部内容
6. 粘贴到查询编辑器中
7. 点击 **Run** 执行

## 第四步：启动后端服务

打开终端，执行：

```bash
cd /Users/will/Downloads/petconnect/admin-backend
python3 main.py
```

看到这样的提示说明成功：
```
✅ 配置验证通过
🚀 服务启动在端口 8000
INFO:     Uvicorn running on http://0.0.0.0:8000
```

**保持这个终端窗口打开！**

## 第五步：启动前端应用

打开**新的**终端窗口，执行：

```bash
cd /Users/will/Downloads/petconnect/admin-portal
npm run dev
```

看到这样的提示：
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

## 第六步：在浏览器打开

打开浏览器，访问：

**http://localhost:5173**

你应该能看到管理后台的深色界面。

## 常见问题

### Q1: 后端启动失败，提示缺少包？

重新安装依赖：
```bash
cd admin-backend
pip3 install -r requirements.txt
```

### Q2: 前端启动失败？

重新安装依赖：
```bash
cd admin-portal
npm install
```

### Q3: 图片上传不可用？

这是正常的，因为还没有配置 R2。你可以：
- 使用外部图片 URL（比如从网上复制图片地址）
- 或者配置 Cloudflare R2（需要单独注册账号）

### Q4: 如何停止服务？

在两个终端窗口中按 `Ctrl + C` 即可停止服务。

## 下次启动

以后每次使用时，只需要：

1. 启动后端：`cd admin-backend && python3 main.py`
2. 启动前端：`cd admin-portal && npm run dev`
3. 浏览器访问：http://localhost:5173

所有数据都存储在 Supabase 云端，完全不需要部署管理系统到服务器。
